\label{dft_of_freezing}

The classical density functional theories derived in chapter
\ref{fundamentals} was first established to study inhomogenous fluids.
Interestingly, one can think of the solid state as an especially extreme
case of an inhomogeneous fluid \cite{HANSEN-CH6}.  In this case, we can
use CDFT to study the circumstances under which the density field develops
long range periodic solutions (ie., solidification).  While not expressed
in precisely this language, this idea dates back as far as 1941 with the
early work of Kirkwood and Monroe \cite{KIRKWOOD_MONROE41} and was later
significantly refined by Youssof and Ramakrishnan \cite{RAMAKRISHNAN79}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Amplitude Expansions} %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

To explore the problem of solidification, we begin with the approximate grand
potential established in equation \ref{cdft_grand_potential} with the external
potential, $\phi(r)$, set to zero,
%
\begin{equation}
    \beta \Delta \Omega[\rho(r)] =
        \int dr \l\lbrace 
            \rho(r)\ln\l(\f{\rho(r)}{\rho_0}\r) - \Delta\rho(r)\r\rbrace
        - \f{1}{2} \Delta\rho(r) \ast C^{(2)}_0(r, r^\prime)
            \ast \Delta\rho(r^\prime).
\end{equation}
%
Scaling out a factor of $\rho_0$ we can rewrite the grand potential in terms of
a dimensionless reduced density, $n(r) \equiv (\rho(x) - \rho_0)/\rho_0$,
%
\begin{equation}
    \label{gp}
    \f{\beta \Delta \Omega[n(r)]}{\rho_0} =
        \int dr \l\lbrace 
            (1 + n(r))\ln\l(1 + n(r)\r) - n(r)\r\rbrace
        - \f{1}{2} n(r) \ast \rho_0 C^{(2)}_0(r, r^\prime) \ast n(r^\prime).
\end{equation}
%
To describe the density profile in the solid state we can expand the density
in a plane waves,
%
\begin{equation}
    \label{expansion}
    n(r) = \bar{n} + \sum_{\mathbf{G}} \xi_{\mathbf{G}} e^{i \mathbf{G} r}.
\end{equation}
%
Where, $\l\lbrace \mathbf{G} \r\rbrace$, is the set of reciprocal lattice
vectors in the crystal lattice and the amplitudes, $\xi_\mathbf{G}$, serve as
order parameters for freezing. In the liquid phase all amplitudes are zero and
the average density is uniform, while in the solid phase there are finite
amplitudes that describe the periodic profile of the crystal lattice. Setting
the liquid at the melting point as our reference fluid we find that, at the 
melting point, $\bar{n}$ is zero for the liquid and is the fractional density
change of solidification, $(\rho_s - \rho_l)/\rho_l$, in the solid phase.

The amplitudes are constrained by the point group symmetry of the lattice.
Grouping the amplitudes of symmetry-equivalent reciprocal lattice vectors
together we can write the density profile as,
%
\begin{equation}
    \label{amplitudes}
    n(r) = \bar{n}
         + \sum_\alpha \l\lbrace
            \xi_\alpha \sum_{\lbrace\mathbf{G}\rbrace_\alpha}
                e^{i\mathbf{G} \cdot \mathbf{x}}\r\rbrace,
\end{equation}
%
Where $\alpha$ is a label running over sets of symmetry-equivalent reciprocal
lattice vectors.

If we insert equation \ref{amplitudes} into equation \ref{gp} and integrate
over the unit cell we find,
%
\begin{align}
    \label{amplitude_gp} 
    \f{\beta \Delta\Omega_{cell}}{\rho_0} &=  \int_{cell} 
        dr \l\lbrace (n(r) + 1)\ln\l(n(r) + 1\r) - n(r) \r\rbrace \nonumber \\
    &- \f{1}{2} \l[\bar{n} ^ 2 \rho_0\tilde{C}^{(2)}_0(0) + \sum_\alpha\rho_0\tilde{C}^{(2)}_0
            (\mathbf{G}_\alpha) \lambda_\alpha\vert\xi_\alpha\vert^2\r],
\end{align}
%
Where $\lambda_\alpha$ is the number of reciprocal lattice vectors in the set
$\alpha$ and $\tilde{C}^{(2)}_0(k)$ is the Fourier transform of the direct
correlation function of the reference fluid. The first term in equation
\ref{amplitude_gp} is convex in all of the amplitudes with a minimum at zero.
It follows that solidification must occur when the direct correlation function
at the reciprocal lattice vectors, $\tilde{C}^{(2)}_0(\mathbf{G}_\alpha)$, is
large enough to stabilize a finite amplitude by creating a new minimum away
from zero.

Furthermore, equation \ref{amplitude_gp} suggests that this transition depends
only on a set of parameters, $\rho_0 \tilde{C}^{(2)}_0(\mathbf{G}_\alpha)$,
that are material independent.  That is to say, once we specify the symmetry of
the lattice a liquid will solidify into (eg.  face-centred-cubic), all
materials that undergo this transition should share these parameters at the
melting point. This seems to be the case for a variety of materials. For
instance, for many liquids solidifying into face-centred-cubic (fcc) lattices,
these parameters for the [111] and [311] reciprocal lattice vectors are 0.65
and 0.23 respectively. Similarly, for a spectrum of liquids solidifying into
body-centred-cubic (bcc) lattices these parameters  for the [110] and [211]
reciprocal lattice vectors are approximately 0.66 and 0.12 respectively.

As seen in table \ref{table:ramakrishnan_argon} and table
\ref{table:ramakrishnan_sodium} theoretical results from this approach match
very closely to experimental values. In spite of the successes of density
functional approach pioneered by Youssof and Ramakrishnan there are limits
to this framework.

\begin{table}[]
    \center
    \begin{tabular}{l c c c}
        \hline 
        Theory & $\tilde{C}(\mathbf{G}_{[111]})$ & $\tilde{C}(\mathbf{G}_{[311]})$ & $\bar{n}$ \\ 
        \hline
        I & 0.95 & 0.0 & 0.074 \\
        II & 0.65 & 0.23 & 0.270 \\
        III & 0.65 & 0.23 & 0.166 \\
        Experiment & 0.65 & 0.23 & 0.148\\
        \hline
    \end{tabular}
    \caption[Freezing parameters for Argon]{Freezing parameters for Argon (fcc)
    taken from \cite{RAMAKRISHNAN79}.  Theory I uses one order paramter, theory
    II uses two order parameters and theory III uses two order parameters and
    expands to third order in the free energy. $\eta$ is the fractional density
    change of solidification 
    $(\rho_s - \rho_l) / \rho_l)$.}
    \label{table:ramakrishnan_argon}
\end{table}

\begin{table}[]
    \center
    \begin{tabular}{l c c c}
        \hline 
        Theory & $\tilde{C}(\mathbf{G}_{[110]})$ & $\tilde{C}(\mathbf{G}_{[211]})$ & $\bar{n}$ \\ 
        \hline
        I           & 0.69 & 0.00 & 0.048 \\
        II          & 0.63 & 0.07 & 0.052 \\
        III         & 0.67 & 0.13 & 0.029 \\
        Experiment  & 0.65 & 0.23 & 0.148\\
        \hline
    \end{tabular}
    \caption[Freezing parameters for Sodium]{Freezing parameters for Sodium
    (bcc) taken from \cite{RAMAKRISHNAN79}.  Theory I uses one order paramter,
    theory II uses two order parameters and theory III uses two order
    parameters and expands to third order in the free energy. $\eta$ is the
    fractional density change of solidification 
    $(\rho_s - \rho_l) / \rho_l)$.}
    \label{table:ramakrishnan_sodium}
\end{table}

Many of the mechanical properties of solids are due to the way in which they
deviate from the perfect crystalline lattice: the microstructure. Grain
boundaries, vacancies, dislocations and second phase particles all play
critical roles in determining the mechanical properties of solids. A simple
example of this is the Hall-Petch effect which states that the yield stress of
a material increases with decreasing grain size,
%
\begin{equation}
    \sigma = \sigma_0 + k_y d^{-1/2},
\end{equation}
%
where, $d$, is the average grain diameter, $\sigma$ is the yield stress,
$\sigma_0$ is yield stress of a single crystal sample and $k_y$ is the
strengthening coefficient.

Microstructure plays key roles not only in the mechanical properties but also
the kinetic pathways of certain phase transformations. For instance,
dislocations can act to catalyze precipication in binary alloys [cite Vahid].

The problem that we face is then, how do we examine these defects and
microstructural elements but retain some of the successful aspects of density
functional approach? One way to think about to consider the microstructure in
the solid state is that it is an artifact of not having fulling reached
equilibrium. Real materials are solidified over a finite time and therefore
haven't fully reached equilibrium. As a result, we should study the pathway to 
equilibrium to gain insight into the origin of microstructure. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Dynamic Density Functional Theory} %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Using techniques from non-equilibrium statistical mechanics we can extend
the density functional approach to a dynamic model. To start we illustrate the 
non-equilibrium method schematically. Consider a non-equilibrium probability 
distribution over phase space, $f(\q, \p; t)$. As a function over phase space,
its equation of motion is a simple result of classical mechanics,
%
\begin{equation}
    \label{cm} 
    \f{d f}{dt} = \l\lbrace f, \mathcal{H} \r\rbrace + \f{\partial f}{\partial t}.
\end{equation}
%
Where, $\l\lbrace \cdot, \cdot \r\rbrace$, denotes the Poisson bracket,
%
\begin{equation}
    \l\lbrace f, g \r\rbrace = \sum_{i = 0}^N \f{\partial f}{\partial q_i}
        \f{\partial g}{\partial p_i} - \f{\partial g}{\partial q_i}
        \f{\partial f}{\partial p_i}.
\end{equation}
%
Of course, the distribution must remain normalized in time and therefore the 
total time derivative must be zero,
%
\begin{equation}
    \int d\q d\p\, f(\q, \p; t) = 1 \rightarrow \f{d f}{dt} = 0.
\end{equation}
%
Accounting for this conservation law in equation \ref{cm}, the resulting
equation of motion is called the \textit{Liouville Equation},
%
\begin{equation}
    \label{liouville} 
    \f{\partial f}{\partial t} = - \l\lbrace f , \mathcal{H} \r\rbrace
\end{equation}
%
Under appropriate conditions the probability distribution, under the action of
the Liouville Equation, will decay to a stable fixed point $f_{eq}(\q, \p)$ we
call equilibrium,
%
\begin{equation}
    \lim_{t \rightarrow \infty} f(\q, \p; t) = f_{eq}(\q, \p)
\end{equation}
%

Using the non-equilibrium probability distribution, we can also discuss
non-equilibrium averages of the density profile and their associated equations
of motions. The non-equilibrium density is written in analogy with equation
\ref{mean_density} by taking of the classical trace of the density operator
over with the non-equilibrium distribution,
%
\begin{equation}
    \rho(x, t) = \mean{\hat{\rho}(x; \q)}_{ne} =
        \trace{\hat{\rho}(x; \q) f(\q, \p, t)}.
\end{equation}
%
Where, $\mean{\cdot}_{ne}$, denotes the non-equilibrium average. Just as the
non-equilibrium probability distribution is driven to equilibrium by the
Liouville Equation, so too is the density profile by its own equation of
motion.

A variety of equations of motion for the density field are known.  For
instance, we can consider the Navier-Stokes equations of hydrodynamics to one
such equation of motion. If we restrict ourselves to diffusion limited
circumstances, we may derive a much simplier equation of motion. To acheive
this result we use the projection operator method, and assume that the 
density operator is the only relevant variable. Quoting the result from
\cite{ESPANOL09} we find,
%
\begin{equation}
    \label{eq:mean_eom}
    \f{\partial \rho(x, t)}{\partial t} = 
        \nabla \cdot \integrate{r^\prime} \mathbf{D}(r, r^\prime, t) 
        \cdot \nabla^\prime \f{\d \F[\rho]}{\d \rho(x^\prime, t)},
\end{equation}
%
Where, $\mathbf{D}(r, r^\prime, t)$, is the diffusion tensor,
%
\begin{equation}
    \mathbf{D}(r, r^\prime, t) = \int_0^\infty \mathrm{d}\tau^\prime\,
        \trace{f(\q, \p, t)\hat{\mathbf{J}}(r, 0)
        \hat{\mathbf{J}}(r^\prime, \tau^\prime)},
\end{equation}
%
in which $\mathbf{J}(r, t)$ is the density flux is,
%
\begin{equation}
    \hat{\mathbf{J}}(r, t) \equiv 
        \sum_i^N \frac{p_i}{m_i} \d(q_i - r).
\end{equation}

Should we use assume 

{
    \color{ForestGreen}

If we restrict ourselves to the case where
transport is diffusion limited and we assume that the dynamic pair correlation
function is the same as the equilibrium pair correlation we can express the
density equation of motion as,
%
\begin{equation}
    \label{mean_eom}
    \f{\partial \rho(x, t)}{\partial t} = 
        \nabla \cdot \l[
            D_0 \rho(x, t) \nabla \l(\f{\d \F[\rho]}{\d \rho(x, t)}\r)
        \r].
\end{equation}
%
Where, $D_0$ is the diffusion constant. We can also express the dynamics of
the density field in the form of a Langevin equation for the density operator,
%
\begin{equation}
    \label{langevin_eom}
    \f{\partial \hat{\rho}(x, t)}{\partial t} =
        \nabla \cdot \l[
            D_0 \hat{\rho}(x, t) \nabla \l(\f{\d \F[\hat{\rho}]}{\d \hat{\rho}}\r)
        \r] + \xi(x, t).
\end{equation}
%
Where, $\mathbf{\xi}(x, t)$ is a Gaussian random driving force with zero mean
and variance of,
%
\begin{equation}
    \mean{\xi(x, t)\xi(x^\prime, t^\prime)} = -2 \nabla \cdot \l[ D_0 \rho(x,t) 
        \nabla \d(x - x^\prime) \d(t - t^\prime)
    \r],
\end{equation}
%
Due to a generalized Einstein relation\footnote{See Appendix \ref{noise} for
details on generalized Einstein relations for nonlinear Langevin equations} for
the Langevin equation in equation \ref{langevin_eom}.

Equation \ref{mean_eom} and \ref{langevin_eom} were first derived by Marconi
and Tarazona by considering an ensemble of interacting Brownian particles, but
other derivations are possible including the projection operator method [cite
Espanol].  Equations \ref{mean_eom} and \ref{langevin_eom} fall under the
heading of \textit{Dynamic Density Functional Theory} (DDFT) or sometimes
\textit{Time dependent density functional theory} (TD-DFT) though we'll use the
former throughout this text.
}

Unfortunately, if we were to use the approximate free energy functional
established in equation \ref{cdft_free_energy} in the dynamic density
functional theory of equation \ref{mean_eom} or \ref{langevin_eom} we would
face a major impedement: the solid state solutions of the density functional
theory approach yield sharply peaked solutions at the position of the atoms in
the lattice. While this is realistic, they are a major challenge for numerical
algorithms. The challenges are two fold: first, these sharp peaks require a fine mesh 
to be resolved resulting in large memory requirement to simulate domains 
of any non-trivial scale and second, lineary stability analysis of most algorithms 
slave the scale of the time step to the scale of the grid spacing so only small
time steps can be taken on a fine mesh.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Phase Field Crystal Theory} %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The phase field crystal theory (PFC) presents a solution to the numerical difficulties
faced by DDFT methods by approximating the free energy in such a say as to retain the
basic features of the theory with a smoother solid state solution. Starting the 
approximate free energy functional of equation \ref{cdft_free_energy} we proceed as
previously by scaling out a factor of the reference density and changing variables
to a dimensionless density $n(r) = (\rho(r) - \rho_0) / \rho_0$,
%
\begin{equation}
    \f{\beta \F[n(r)]}{\rho_0} = 
        \int dr \l\lbrace (n(r) + 1) \ln( n(r) + 1) - (1 - \beta\mu)n(r) \r\rbrace
        - \f{1}{2} n(r) \ast \rho_0 C^{(2)}_0(r, r^\prime) \ast n(r^\prime).
\end{equation}
%
We then Taylor expand the logarithm about the reference density or equivalently
$n(r) = 0$, to fourth order,
%
\begin{equation}
    \label{pfc_free_energy} 
    \f{\beta \F[n(r)]}{\rho_0} =
        \int dr \l\lbrace \f{n(r)^2}{2} - \f{n(r)^3}{6} + \f{n(r)^4}{12} \r\rbrace
        -\f{1}{2} n(r) \ast \rho_0 C^{(2)}_0(r, r^\prime) \ast n(r^\prime).
\end{equation}
%
Where the linear term has been dropped because it leaves the equations of
motion invariant.  Most phase field crystal theories also use a simplified
equation of motion as well,
%
\begin{equation}
    \label{pfc_eom}
    \f{\partial n(r, t)}{\partial t} = M \nabla^2 \l(\f{\d \F[n(r)]}{\d n(r)}\r).
\end{equation}
%
